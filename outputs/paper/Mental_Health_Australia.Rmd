---
title: "Mental Health in Australia"
subtitle: "My subtitle if needed"
author: 
  - Christina Chan-Ying
  - Yan Dumalag
  - Reese Halfyard
thanks: "Code and data are available at: https://github.com/ChristinaChanYing/Australian-Social-Determinants-of-Health"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tibble)
library(reshape)
library(tidyverse)
library(ggplot2)
library(kableExtra)
library(dplyr)
```

# Introduction

You can and should cross-reference sections and sub-sections. For instance, Section \@ref(data). R Markdown automatically makes the sections lower case and adds a dash to spaces to generate labels, for instance, Section \@ref(first-discussion-point). 

```{r, include=FALSE}
### Grabbing the data ###
female_data <- readr::read_csv(here::here("inputs/data/cleaned_data_females.csv")) |>
   as_tibble() |>
  select(Section, Modules, `Has a mental health condition`, `Does not have a mental health condition`, `Has a long term health condition`, `Does not have a long term health condition`, `Has disability`, `Has no disability`, `Total persons`) |>
  mutate(Gender = "female")

male_data <- readr::read_csv(here::here("inputs/data/cleaned_data_males.csv")) |>
   as_tibble() |>
  select(Section, Modules, `Has a mental health condition`, `Does not have a mental health condition`, `Has a long term health condition`, `Does not have a long term health condition`, `Has disability`, `Has no disability`, `Total persons`)|>
  mutate(Gender = "male")

persons_data <- readr::read_csv(here::here("inputs/data/cleaned_data_persons.csv")) |>
   as_tibble() |>
  select(Section, Modules, `Has a mental health condition`, `Does not have a mental health condition`, `Has a long term health condition`, `Does not have a long term health condition`, `Has disability`, `Has no disability`, `Total persons`)

female_male_data <-
    merge(x = female_data, y = male_data, by = c("Section", "Modules", "Has a mental health condition", "Does not have a mental health condition", "Has a long term health condition", "Does not have a long term health condition", "Has disability", "Has no disability", "Total persons", "Gender"), all = TRUE) |>
  group_by(Gender)

```

```{r trust, fig.cap = "Trust: Feels most people can be trusted", echo = FALSE}
female_male_trust <- subset(female_male_data, Section == "Feels most people can be trusted")

trust <- ggplot(female_male_trust, aes(x = Modules, y = `Total persons`, group = Gender, fill = Gender)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  geom_text(aes(label=`Total persons`), vjust=1.6, color="black",
            position = position_dodge(0.9), size=3.5)+
  theme_minimal() + 
  scale_x_discrete(labels = function(x) str_wrap(x, width = 25))

trust + scale_fill_manual(values=c('#d9848e','#84a8d9'))

```

```{r mhc-trust, fig.cap="People that strongly agrees most people can be trusted", echo = FALSE}
has_mhc_trust <- subset(female_male_data, Section == "Feels most people can be trusted" & Modules == "Strongly agree / Somewhat agree") |>
  select(`Has a mental health condition`, Gender) |>
  rename(`Number of People` = `Has a mental health condition`) |>
  mutate(`Has a mental health condition` = "Yes")
  
no_mhc_trust <- subset(female_male_data, Section == "Feels most people can be trusted" & Modules == "Strongly agree / Somewhat agree") |>
  select(`Does not have a mental health condition`, Gender) |>
  rename(`Number of People` = `Does not have a mental health condition`) |>
  mutate(`Has a mental health condition` = "No")

mhc_trust <- merge(x = has_mhc_trust, y = no_mhc_trust, all = TRUE)

mhc_trust <- ggplot(mhc_trust, aes(x = `Has a mental health condition`, y = `Number of People`, group = Gender, fill = Gender)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  geom_text(aes(label = `Number of People`), vjust=1.6, color="black",
            position = position_dodge(0.9), size=3.5)+
  theme_minimal()

mhc_trust + scale_fill_manual(values=c('#d9848e','#84a8d9'))

```


```{r discrimination, fig.cap="Has experienced discrimination in last 12 months", echo = FALSE}
person_discrim <- subset(persons_data, Modules == "Has experienced discrimination in last 12 months", select = -c(Section, Modules))

person_discrim <- as.data.frame(t(person_discrim[,-1]))

person_discrim <- tibble::rownames_to_column(person_discrim, "Category")

names(person_discrim)[names(person_discrim) == "V1"] <- "Number of People"

person_discrim |>
  ggplot(aes(x = `Category`, y = `Number of People`)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  geom_text(aes(label = `Number of People`), vjust=1.6, color="white",
            position = position_dodge(0.9), size=3.5)+
  theme_minimal() + 
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15))


```

```{r stressors, fig.cap="Male vs Female Stressors", echo = FALSE}
stressors <- subset(female_male_data, Section == "Stressors", select = -c(Section))

stressors <- ggplot(stressors, aes(x = Modules, y = `Total persons`, group = Gender, fill = Gender)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  geom_text(aes(label = `Total persons`), vjust=1.6, color="black",
            position = position_dodge(0.9), size=3.5)+
  theme_minimal() +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 20))

stressors + scale_fill_manual(values=c('#d9848e','#84a8d9'))


```

# Data

```

Talk more about it.

Also bills and their average (Figure \@ref(fig:billssssss)). (Notice how you can change the height and width so they don't take the whole page?)

Talk way more about it. 



# Model

\begin{equation}
Pr(\theta | y) = \frac{Pr(y | \theta) Pr(\theta)}{Pr(y)}  (\#eq:bayes)
\end{equation}

Equation \@ref(eq:bayes) seems useful, eh?

Here's a dumb example of how to use some references: In paper we run our analysis in `R` [@citeR]. We also use the `tidyverse` which was written by @thereferencecanbewhatever If we were interested in baseball data then @citeLahman could be useful. 

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


